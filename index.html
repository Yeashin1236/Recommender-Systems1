<!DOCTYPE html>
<html>
<head>
    <title>Two-Tower Recommender (TensorFlow.js)</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.6.0/dist/tf.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 1000px; margin: auto; }
        h1 { color: #2C3E50; }
        .controls, .training, .recommendations, .visualization {
            border: 1px solid #BDC3C7;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
        }
        .training-log {
            max-height: 200px;
            overflow-y: scroll;
            background-color: #ECF0F1;
            padding: 10px;
            margin-top: 10px;
            font-family: monospace;
            font-size: 12px;
        }
        button {
            padding: 10px 15px;
            background-color: #3498DB;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:disabled {
            background-color: #AAB7B8;
        }
        #visualization-container {
            width: 100%;
            height: 500px;
        }
        .recommendation-list {
            list-style: none;
            padding: 0;
        }
        .recommendation-list li {
            padding: 5px 0;
            border-bottom: 1px dotted #BDC3C7;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Two-Tower Recommender (MovieLens 100k)</h1>

        <div class="controls">
            <h2>Setup & Data</h2>
            <p><strong>Status:</strong> <span id="status">Loading data...</span></p>
            <p>
                <button id="train-button" onclick="app.startTraining()" disabled>Start Training (10 Epochs)</button>
            </p>
            <p>
                <label for="user-select">Select User for Recommendations:</label>
                <select id="user-select" onchange="app.updateUserInfo(this.value)" disabled></select>
            </p>
        </div>

        <div class="training">
            <h2>Training Progress</h2>
            <p>Epoch: <span id="epoch-counter">0</span> | Loss: <span id="loss-display">N/A</span></p>
            <div class="training-log" id="training-log"></div>
        </div>

        <div class="recommendations">
            <h2>Recommendations for User <span id="current-user-id">N/A</span></h2>
            <ul id="recommendation-list" class="recommendation-list">
                <li>*Train the model to see recommendations*</li>
            </ul>
        </div>

        <div class="visualization">
            <h2>Item Embedding Visualization (2D PCA)</h2>
            <p id="viz-status">Visualization requires training the model first.</p>
            <div id="visualization-container"></div>
        </div>
    </div>

    <script src="two-tower.js"></script>
    <script src="app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
</body>
</html>
